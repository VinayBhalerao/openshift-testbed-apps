apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: cron-producer2
  generation: 1
spec:
  schedule: '*/2 * * * *'
  concurrencyPolicy: Allow
  jobTemplate:
    spec:
      parallelism: 1
      completions: 4
      template:
        metadata:
          annotations:
            argocd.argoproj.io/hook: PostSync
            argocd.argoproj.io/hook-delete-policy: HookSucceeded
        spec:
          containers:
          - name: cron-producer2
            image: strimzi/kafka:0.12.1-kafka-2.2.1
            imagePullPolicy: IfNotPresent
            #resources:
            #  requests:
            #    memory: "400Mi"
            #    cpu: "250m"
            #  limits:
            #    memory: "500Mi"
            #    cpu: "250m"
            command:
              - sh
              - -c
              - "kafka-producer-perf-test --topic my-topic2 --num-records 2500000 --record-size 10 --throughput 10000000 --producer-props acks=1 buffer.memory=67108864 compression.type=lz4 batch.size=20000 linger.ms=100 retries=0 bootstrap.servers=my-cluster-kafka-bootstrap.myproject:9092"
          restartPolicy: OnFailure
      backoffLimit: 5
